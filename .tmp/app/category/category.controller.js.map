{"version":3,"sources":["../../../client/app/category/category.controller.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,CAC3B,UAAU,CAAC,cAAc,EAAE,CAAC,QAAQ,EAAE,cAAc,EAAE,SAAS,EAAC,YAAY,EAAC,QAAQ,EAAE,UAAS,MAAM,EAAE,YAAY,EAAE,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE;;AAElJ,QAAM,CAAC,aAAa,GAAG,YAAY,CAAC,IAAI,CAAC;AACzC,QAAM,CAAC,aAAa,GAAG,UAAS,SAAS,EAAC;;AAExC,QAAI,MAAM,GAAG,EAAE,EAAE,EAAC,SAAS,EAAE,UAAU,EAAE,MAAM,CAAC,UAAU,EAAE,aAAa,EAAC,MAAM,CAAC,aAAa,EAAE,CAAC;AACjG,UAAM,CAAC,EAAE,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;GAC9B,CAAA;;AAED,cAAY,CAAC,IAAI,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,GAAG,OAAO,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;;AAEpI,QAAM,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,CAAC;AAC1C,QAAM,CAAC,aAAa,GAAG,UAAU,CAAC,aAAa,CAAC;CACjD,CAAC,CAAC,CAAC;;AAEJ,IAAI,gBAAgB,GAAG,SAAnB,gBAAgB,CAAG,CAAC;SAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,EAAE,UAAC,CAAC,EAAE,CAAC;WAAK,CAAC,GAAG,CAAC,CAAC,MAAM;GAAA,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;CAAA,CAAC;;AAEzG,IAAI,OAAO,GAAG,SAAV,OAAO,CAAG,MAAM;SAAI,UAAA,IAAI,EAAI;AAC9B,WAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAClB,UAAM,CAAC,QAAQ,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,UAAA,EAAE;aAAI,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,gBAAgB,CAAC,EAAE,CAAC,EAAE,CAAC;KAAA,CAAC,CAAC;;AAE3F,UAAM,CAAC,WAAW,GAAG,CAAC,CAAC;AACvB,UAAM,CAAC,UAAU,GAAG,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;AAC3C,UAAM,CAAC,YAAY,GAAG,EAAE,CAAC;AACzB,UAAM,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC;GACvE;CAAA,CAAA","file":"category.controller.js","sourcesContent":["'use strict';\n\nangular.module('bhcmartApp')\n.controller('CategoryCtrl', ['$scope', '$stateParams', 'Product','$rootScope','$state', function($scope, $stateParams, Product, $rootScope, $state) {\n\n  $scope.categoryTitle = $stateParams.slug;\n  $scope.addtoRegistry = function(productId){\n\n    var result = { id:productId, registryId: $scope.registryId, registryTitle:$scope.registrytitle };\n    $state.go('product', result);\n  }\n\n  $stateParams.slug == 'all' ? Product.query(process($scope)) : Product.catalog({ id: $stateParams.slug, limit: 0 }, process($scope));\n\n  $scope.registryId = $rootScope.registryId;\n  $scope.registrytitle = $rootScope.registryTitle;\n}]);\n\nlet getAverageRating = p => Math.ceil(_.reduce(p.reviews, (a, b) => a + b.rating, 0) / p.reviews.length);\n\nlet process = $scope => prod => {\n  console.log(prod);\n  $scope.products = _.map(prod, rP => _.extend(rP, { averageRating: getAverageRating(rP) }));\n  // pagination controls\n  $scope.currentPage = 1;\n  $scope.totalItems = $scope.products.length;\n  $scope.itemsPerPage = 20; // items per page\n  $scope.noOfPages = Math.ceil($scope.totalItems / $scope.itemsPerPage);\n}\n"]}