{"version":3,"sources":["../../../client/app/category/category.controller.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,CAC3B,UAAU,CAAC,cAAc,EAAE,CAAC,QAAQ,EAAE,cAAc,EAAE,SAAS,EAAC,YAAY,EAAC,QAAQ,EAAE,SAAS,EAAC,UAAS,MAAM,EAAE,YAAY,EAAE,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO,EAAE;;AAErK,QAAM,CAAC,aAAa,GAAG,YAAY,CAAC,IAAI,CAAC;;AAEzC,QAAM,CAAC,KAAK,GAAG,CAAC,GAAG,EAAC,GAAG,EAAC,GAAG,EAAC,IAAI,EAAC,KAAK,CAAC,CAAC;AACxC,QAAM,CAAC,MAAM,GAAG,CAAC,MAAM,EAAC,OAAO,EAAC,OAAO,EAAC,KAAK,CAAC,CAAC;AAC/C,QAAM,CAAC,UAAU,GAAG,CAAC,QAAQ,EAAG,UAAU,EAAE,QAAQ,CAAC,CAAC;;AAEtD,QAAM,CAAC,IAAI,GAAG,CAAC,CAAC;;AAEhB,QAAM,CAAC,IAAI,GAAG,CAAC,CAAC;;AAEhB,QAAM,CAAC,WAAW,GAAG,EAAE,CAAC;;;;;;;;;;AAUxB,QAAM,CAAC,MAAM,GAAG;AACd,YAAQ,EAAE,CAAC;AACX,YAAQ,EAAE,KAAK;AACf,WAAO,EAAE;AACP,WAAK,EAAE,CAAC;AACR,UAAI,EAAE,KAAK;AACX,UAAI,EAAE,CAAC;AACP,WAAK,EAAE,iBAAW;AAChB,cAAM,CAAC,MAAM,EAAE,CAAC;OAEjB;KACF;GACF,CAAC;;AAGF,QAAM,CAAC,QAAQ,GAAG;AAChB,SAAK,EAAE,EAAE;AACT,UAAM,EAAG,EAAE;GACZ,CAAC;;;;AAKJ,QAAM,CAAC,eAAe,GAAG,UAAS,CAAC,EAAC;AAClC,UAAM,CAAC,QAAQ,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,UAAS,GAAG,EAAC;AAC9C,aAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;KAClB,CAAC,CAAC;AACH,WAAO,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAA;AAC5B,WAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AACf,WAAO,CAAC,YAAY,CAAC,CAAC,EAAE,UAAS,GAAG,EAAC;AACnC,YAAM,CAAC,UAAU,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;AACjC,aAAO,CAAC,GAAG,CAAC,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,CAAA;AACxC,YAAM,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,GAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAC9D,aAAO,CAAC,GAAG,CAAC,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC;AACzC,UAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,EAAC;AAClC,cAAM,CAAC,YAAY,GAAG,IAAI,CAAC;OAC5B;AACD,UAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,EAAC;AAClC,eAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;AAChC,cAAM,CAAC,YAAY,GAAG,KAAK,CAAC;OAC7B;KACF,CAAC,CAAC;GAEJ,CAAA;;AAED,QAAM,CAAC,WAAW,GAAG,YAAU;AAC7B,UAAM,CAAC,MAAM,CAAC,KAAK,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;GAClC,CAAC;;AAEF,QAAM,CAAC,YAAY,GAAG,YAAU;AAC9B,UAAM,CAAC,MAAM,CAAC,KAAK,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;GAClC,CAAA;;AAID,QAAM,CAAC,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,YAAY,CAAC,IAAI,EAAE,EAAE,UAAS,QAAQ,EAAC;AACzE,WAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;AACrB,UAAM,CAAC,kBAAkB,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AACrE,QAAI,CAAC,GAAG,EAAC,KAAK,EAAC,EAAC,MAAM,EAAC,QAAQ,CAAC,GAAG,EAAC,EAAC,CAAC;AACtC,UAAM,CAAC,eAAe,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;;AAEzC,UAAM,CAAC,MAAM,CAAC,IAAI,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;GACjC,CAAC,CAAC;;AAMH,QAAM,CAAC,QAAQ,GAAG,YAAU;AAC1B,QAAG,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,UAAU,EAAC;AACjC,YAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,GAAG,CAAC,CAAC;AAC9B,YAAM,CAAC,MAAM,CAAC,KAAK,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;;;;;;;;;;KAU5B;;AAED,QAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,EAAC;AAClC,YAAM,CAAC,YAAY,GAAG,IAAI,CAAC;KAC5B;AACD,QAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,EAAC;AAClC,aAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;AAChC,YAAM,CAAC,YAAY,GAAG,KAAK,CAAC;KAC7B;GAGF,CAAA;;AAED,QAAM,CAAC,YAAY,GAAG,YAAU;;AAE9B,QAAG,MAAM,CAAC,IAAI,GAAG,CAAC,EAAC;AACjB,YAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,GAAG,CAAC,CAAC;AAC9B,YAAM,CAAC,MAAM,CAAC,KAAK,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KAClC;AACD,QAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,EAAC;AAClC,YAAM,CAAC,YAAY,GAAG,IAAI,CAAC;KAC5B;AACD,QAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,EAAC;AAClC,aAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;AAChC,YAAM,CAAC,YAAY,GAAG,KAAK,CAAC;KAC7B;;;;GAMP,CAAA;;AAED,QAAM,CAAC,MAAM,GAAG,UAAS,KAAK,EAAC,IAAI,EAAC;;AAEnC,QAAI,CAAC,GAAG,EAAE,CAAC;AACX,QAAI,CAAC,GAAG,EAAE,CAAC;AACX,KAAC,CAAC,IAAI,CAAC,EAAC,YAAY,EAAG,EAAE,GAAG,EAAE,MAAM,CAAC,kBAAkB,EAAG,EAAE,CAAC,CAAC;AAC9D,KAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAG,EAAE,GAAG,EAAE,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,GAAG,EAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;;AAEjF,QAAI,KAAK,GAAG,EAAE,CAAC;;AAEf,WAAO,CAAC,GAAG,CAAC,eAAe,GAAE,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAA;AAC9D,WAAO,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;AAClC,WAAO,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAC,UAAS,IAAI,EAAC;AAC/D,UAAG,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,EAAC;AAC7B,aAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;OAClB;KACF,CAAC,CAAC;;AAEH,QAAG,KAAK,CAAC,MAAM,GAAG,CAAC,EAAC;AAClB,aAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;AAC5B,OAAC,CAAC,IAAI,CAAC,EAAC,MAAM,EAAG,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;KACpC;;AAED,QAAI,MAAM,GAAG,EAAE,CAAC;;AAEhB,WAAO,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAC,UAAS,KAAK,EAAC;AACjE,UAAG,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,EAAC;AAC/B,cAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;OACpB;KACF,CAAC,CAAC;;AAEH,QAAG,MAAM,CAAC,MAAM,GAAG,CAAC,EAAC;AACnB,aAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;AAC7B,aAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACpB,OAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAG,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC;KACtC;AACD,KAAC,CAAC,KAAK,GAAG,EAAE,IAAI,EAAG,CAAC,EAAC,CAAC;AACtB,KAAC,CAAC,IAAI,GAAG,KAAK,CAAC;AACf,KAAC,CAAC,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,CAAC,CAAA,GAAG,MAAM,CAAC,IAAI,CAAC;AACxC,KAAC,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;;;;AAKrB,UAAM,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;GAC3B,CAAA;CAWA,CAAC,CAAC,CAAC","file":"category.controller.js","sourcesContent":["'use strict';\n\nangular.module('bhcmartApp')\n.controller('CategoryCtrl', ['$scope', '$stateParams', 'Product','$rootScope','$state', 'Catalog',function($scope, $stateParams, Product, $rootScope, $state, Catalog) {\n\n  $scope.categoryTitle = $stateParams.slug;\n\n  $scope.sizes = [\"S\",\"M\",\"L\",\"XL\",\"XXL\"];\n  $scope.colors = [\"Blue\",\"Brown\",\"Green\",\"Red\"];\n  $scope.pricerange = [\"0 -500\" , \"500-5000\", \"5000 +\"];\n  \n  $scope.page = 1;\n\n  $scope.list = 5;\n\n  $scope.priceSlider = {};\n/*\n  $scope.priceSlider = {\n    min: 0,\n    max: 10000,\n    ceil: 10000,\n    floor: 0,\n    step:100\n  };*/\n\n  $scope.slider = {\n    minValue: 0,\n    maxValue: 10000,\n    options: {\n      floor: 0,\n      ceil: 10000,\n      step: 1,\n      onEnd: function() {\n        $scope.filter();\n\n      }\n    }\n  };\n\n\n  $scope.selected = {\n    sizes: {},\n    colors : {}\n  };\n\n//    selected.sizes\n\n\n$scope.displayProducts = function(q){\n  $scope.products = Product.query(q, function(res){\n    console.log(res);\n  });\n  console.log($scope.products)\n  console.log(q);\n  Product.productCount(q, function(res){\n    $scope.totalItems = res[0].count;\n    console.log(\"items\" + $scope.totalItems)\n    $scope.totalPages = Math.round($scope.totalItems/$scope.list);\n    console.log(\"pages\" + $scope.totalPages);\n    if($scope.totalPages == $scope.page){\n      $scope.disablednext = true;\n    }\n    if($scope.totalPages != $scope.page){\n      console.log(\"inside second if\");\n      $scope.disablednext = false;\n    }\n  });  \n\n}\n\n$scope.sizechanged = function(){\n  $scope.filter(false,$scope.page);\n};\n\n$scope.colorchanged = function(){\n  $scope.filter(false,$scope.page);\n}\n\n\n\n$scope.category = Catalog.get({ id: $stateParams.slug }, function(category){\n  console.log(category)\n  $scope.selectedcategories = [category._id].concat(category.children);\n  var r = {where:{parent:category._id}};\n  $scope.childcategories = Catalog.query(r)\n\n  $scope.filter(true,$scope.page);\n});\n\n\n\n\n\n$scope.nextPage = function(){\n  if($scope.page < $scope.totalPages){\n    $scope.page = $scope.page + 1;\n    $scope.filter(false,$scope.page);\n        /*  var q = {};\n          var f = [];\n          f.push({'categories' : { $in: $scope.selectedcategories  } }); \n          q.where = { $and : f};\n          q.sort = 'asc';\n          q.skip = ($scope.page - 1 )*$scope.list;\n          console.log(\"skip\" + q.skip);\n          q.list = $scope.list;\n          $scope.displayProducts(q);*/\n        }\n\n        if($scope.totalPages == $scope.page){\n          $scope.disablednext = true;\n        }\n        if($scope.totalPages != $scope.page){\n          console.log(\"inside second if\");\n          $scope.disablednext = false;\n        }\n\n\n      }\n\n      $scope.previousPage = function(){\n\n        if($scope.page > 1){\n          $scope.page = $scope.page - 1;\n          $scope.filter(false,$scope.page);\n        }\n        if($scope.totalPages == $scope.page){\n          $scope.disablednext = true;\n        }\n        if($scope.totalPages != $scope.page){\n          console.log(\"inside second if\");\n          $scope.disablednext = false;\n        }\n\n\n   /* $scope.page = $scope.page - 1;\n\n   $stateParams.slug == 'all' ? Product.query(process($scope)) : Product.catalog({ id: $stateParams.slug, limit: 4, page : $scope.page  },q);*/\n }\n\n $scope.filter = function(flush,page){\n\n  var q = {};\n  var f = [];\n  f.push({'categories' : { $in: $scope.selectedcategories  } }); \n  f.push({'price' : { $gt: $scope.slider.minValue, $lt:$scope.slider.maxValue } });\n\n  var sizes = [];\n  /*console.log(\"sizes\"+Object.keys($scope.selected.sizes));*/\n  console.log(\"selectedsizes\"+ $scope.selected.sizes.toString())\n  console.log($scope.selected.sizes)\n  angular.forEach(Object.keys($scope.selected.sizes),function(size){\n    if($scope.selected.sizes[size]){\n      sizes.push(size);\n    }\n  });\n  \n  if(sizes.length > 0){\n    console.log(\"inside sizes\");\n    f.push({'size' : { $in: sizes } });\n  }\n\n  var colors = [];\n  /*console.log(\"sizes\"+Object.keys($scope.selected.sizes));*/\n  angular.forEach(Object.keys($scope.selected.colors),function(color){\n    if($scope.selected.colors[color]){\n      colors.push(color);\n    }\n  });\n  \n  if(colors.length > 0){\n    console.log(\"inside colors\");\n    console.log(colors);\n    f.push({'color' : { $in: colors } });\n  }\n  q.where = { $and : f};\n  q.sort = 'asc';\n  q.skip = ($scope.page - 1 )*$scope.list;\n  q.list = $scope.list;\n\n  /*console.log($scope.selected.sizes);*/\n\n\n  $scope.displayProducts(q);\n}\n\n\n\n\n\n\n\n\n\n\n}]);\n/*\nlet getAverageRating = p => Math.ceil(_.reduce(p.reviews, (a, b) => a + b.rating, 0) / p.reviews.length); */\n\n/*let process = $scope => prod => {\n  console.log(prod);\n  \n  // pagination controls\n  $scope.currentPage = 1;\n  $scope.totalItems = $scope.products.length;\n  console.log($scope.totalItems)\n  $scope.itemsPerPage = 5; // items per page\n  $scope.noOfPages = Math.ceil($scope.totalItems / $scope.itemsPerPage);\n}*/\n"]}