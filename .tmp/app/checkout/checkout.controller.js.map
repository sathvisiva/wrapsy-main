{"version":3,"sources":["../../../client/app/checkout/checkout.controller.js"],"names":[],"mappings":"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","file":"checkout.controller.js","sourcesContent":["'use strict';\n\nangular.module('bhcmartApp')\n  .controller('CheckoutCtrl', ['$scope', 'Auth', '$state', 'Order', 'ngCart','toaster', function($scope, Auth, $state, Order, ngCart, toaster) {\n\n    $scope.user = Auth.getCurrentUser() || {};\n    $scope.user.country = \"In\"\n    \n    $scope.isLoggedIn = Auth.isLoggedIn();\n    $scope.errors = {};\n    $scope.submitted = false;\n    \n    $scope.states = [\n{\n\"key\": \"AN\",\n\"name\": \"Andaman and Nicobar Islands\"\n},\n{\n\"key\": \"AP\",\n\"name\": \"Andhra Pradesh\"\n},\n{\n\"key\": \"AR\",\n\"name\": \"Arunachal Pradesh\"\n},\n{\n\"key\": \"AS\",\n\"name\": \"Assam\"\n},\n{\n\"key\": \"BR\",\n\"name\": \"Bihar\"\n},\n{\n\"key\": \"CG\",\n\"name\": \"Chandigarh\"\n},\n{\n\"key\": \"CH\",\n\"name\": \"Chhattisgarh\"\n},\n{\n\"key\": \"DH\",\n\"name\": \"Dadra and Nagar Haveli\"\n},\n{\n\"key\": \"DD\",\n\"name\": \"Daman and Diu\"\n},\n{\n\"key\": \"DL\",\n\"name\": \"Delhi\"\n},\n{\n\"key\": \"GA\",\n\"name\": \"Goa\"\n},\n{\n\"key\": \"GJ\",\n\"name\": \"Gujarat\"\n},\n{\n\"key\": \"HR\",\n\"name\": \"Haryana\"\n},\n{\n\"key\": \"HP\",\n\"name\": \"Himachal Pradesh\"\n},\n{\n\"key\": \"JK\",\n\"name\": \"Jammu and Kashmir\"\n},\n{\n\"key\": \"JH\",\n\"name\": \"Jharkhand\"\n},\n{\n\"key\": \"KA\",\n\"name\": \"Karnataka\"\n},\n{\n\"key\": \"KL\",\n\"name\": \"Kerala\"\n},\n{\n\"key\": \"LD\",\n\"name\": \"Lakshadweep\"\n},\n{\n\"key\": \"MP\",\n\"name\": \"Madhya Pradesh\"\n},\n{\n\"key\": \"MH\",\n\"name\": \"Maharashtra\"\n},\n{\n\"key\": \"MN\",\n\"name\": \"Manipur\"\n},\n{\n\"key\": \"ML\",\n\"name\": \"Meghalaya\"\n},\n{\n\"key\": \"MZ\",\n\"name\": \"Mizoram\"\n},\n{\n\"key\": \"NL\",\n\"name\": \"Nagaland\"\n},\n{\n\"key\": \"OR\",\n\"name\": \"Odisha\"\n},\n{\n\"key\": \"PY\",\n\"name\": \"Puducherry\"\n},\n{\n\"key\": \"PB\",\n\"name\": \"Punjab\"\n},\n{\n\"key\": \"RJ\",\n\"name\": \"Rajasthan\"\n},\n{\n\"key\": \"SK\",\n\"name\": \"Sikkim\"\n},\n{\n\"key\": \"TN\",\n\"name\": \"Tamil Nadu\"\n},\n{\n\"key\": \"TS\",\n\"name\": \"Telangana\"\n},\n{\n\"key\": \"TR\",\n\"name\": \"Tripura\"\n},\n{\n\"key\": \"UP\",\n\"name\": \"Uttar Pradesh\"\n},\n{\n\"key\": \"UK\",\n\"name\": \"Uttarakhand\"\n},\n{\n\"key\": \"WB\",\n\"name\": \"West Bengal\"\n}\n]\n\n\n\n    $scope.login = (form) => {\n      $scope.submitted = true;\n\n      if (form.$valid) {\n        Auth.login({\n            email: $scope.user.email,\n            password: $scope.user.password\n          })\n          .then(() => {\n            $state.reload();\n          })\n          .catch(err => {\n            $scope.errors.other = err.message;\n          });\n      }\n    }\n\n    $scope.validate = form => {\n      if(!$scope.isLoggedIn){\n        toaster.pop('error', \"Please login to continue\");\n      }      \n      if (form.$valid && ( $scope.user.state || $scope.user.state != \"\")) {\n        $scope.message = '';\n        $scope.submitted = true;\n      }else{\n        toaster.pop('error', \"Please check the data entered\");\n      }\n    }\n\n\n    $scope.checkout = (cart, user) => {\n\n      \n      if (user.name && user.email && user.phone && user.address && user.city && user.country) {\n        _.map(cart.items, i => {\n          i.productId = i.id;\n          delete i.data;\n          delete i.id;\n          return i;\n        })\n\n        cart = _.extend(cart, {\n          customerId: user._id ? user._id : '',\n          customerName: user.name,\n          customerEmail: user.email,\n          customerAddress: user.address,\n          customerPhone: user.phone,\n          customerCity: user.city,\n          customerState: user.state ? user.state : '',\n          customerCountry: user.country\n        });\n\n        Order.save(cart,\n          function(resp) {\n            ngCart.empty();\n            $state.go('invoice', {id: resp._id});\n          },\n          function(err) {\n            toaster.pop('error', \"Please Try again later\");\n          });\n      } else {\n        $scope.message = 'Please, complete the shipping section and click on continue'\n      }\n    }\n  }]);\n"]}