{"version":3,"sources":["../../../client/app/checkout/checkout.controller.js"],"names":[],"mappings":"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","file":"checkout.controller.js","sourcesContent":["'use strict';\n\nangular.module('bhcmartApp')\n.controller('CheckoutCtrl', ['$scope', 'Auth', '$state', 'Order', 'ngCart','toaster','Voucher', function($scope, Auth, $state, Order, ngCart, toaster,Voucher) {\n  $state.go('checkout.shipping')\n  $scope.user = Auth.getCurrentUser() || {};\n  $scope.user.country = \"In\"\n\n  $scope.isLoggedIn = Auth.isLoggedIn();\n  $scope.errors = {};\n  $scope.submitted = false;\n\n  $scope.disableorder = true ; \n  $scope.disablepayment = true;\n\n  var q = {where:{email:Auth.getCurrentUser().email}};\n /* $scope.vouchers =  Voucher.query(q);\n  console.log($scope.vouchers)\n  */\n\n\n/*\n  $scope.savelocation = function(form){\n    $scope.locationformsubmitted = false;\n    if (!form.$valid) {\n      $scope.locationformsubmitted = true\n    }else{\n      $scope.disablemessage = false;\n      $state.go('createregistry.message');\n    }\n\n  }*/\n\n  $scope.redeemVoucher = function(voucher1){\n    var data = {code:voucher1};\n    Voucher.redeem(data, function(resp) {\n      \n    }, function(err) {\n      console.log(err)\n    })\n\n  }\n\n\n  $scope.validate = form => {\n    if(!$scope.isLoggedIn){\n      toaster.pop('error', \"Please login to continue\");\n    }      \n    console.log(\"state\" + $scope.user.state)\n    if (form.$valid && ( $scope.user.state || $scope.user.state != \"\")) {\n      $scope.message = '';\n      $scope.submitted = true;\n    }else{\n      toaster.pop('error', \"Please check the data entered\");\n    }\n  }\n\n\n  $scope.checkout = (cart, user) => {\n\n\n    if (user.name && user.email && user.phone && user.address && user.city && user.country) {\n      _.map(cart.items, i => {\n        i.productId = i.id;\n        delete i.data;\n        delete i.id;\n        return i;\n      })\n\n      cart = _.extend(cart, {\n        customerId: user._id ? user._id : '',\n        customerName: user.name,\n        customerEmail: $scope.user.email,\n        customerAddress: user.address,\n        customerAddress1: user.address1,\n        customerlandmark : user.landmark,\n        customerPhone: user.phone,\n        customerCity: user.city,\n        customerState: user.state ? user.state : '',\n        customerCountry: 'India'\n      });\n\n      Order.save(cart,\n        function(resp) {\n          ngCart.empty();\n          $state.go('invoice', {id: resp._id});\n        },\n        function(err) {\n          toaster.pop('error', \"Please Try again later\");\n        });\n    } else {\n      $scope.message = 'Please, complete the shipping section and click on continue'\n    }\n  }\n}]);\n"]}