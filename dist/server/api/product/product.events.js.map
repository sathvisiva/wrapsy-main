{"version":3,"sources":["../../../../server/api/product/product.events.js"],"names":[],"mappings":";;;;AAIC,YAAY,CAAC;;AAEb,IAAI,YAAY,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC;AAClD,IAAI,OAAO,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC;AACjD,IAAI,KAAK,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC,KAAK,CAAC;AAC7C,IAAI,MAAM,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC,MAAM,CAAC;AAC/C,IAAI,OAAO,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC;;AAEjD,IAAI,aAAa,GAAG,IAAI,YAAY,EAAE,CAAC;AACvC,IAAI,WAAW,GAAG,IAAI,YAAY,EAAE,CAAC;AACrC,IAAI,YAAY,GAAG,IAAI,YAAY,EAAE,CAAC;AACtC,IAAI,aAAa,GAAG,IAAI,YAAY,EAAE,CAAC;;;AAIvC,aAAa,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;AACjC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;AAC/B,YAAY,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;AAChC,aAAa,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;;;AAGjC,IAAI,MAAM,GAAG;AACX,QAAM,EAAE,MAAM;AACd,UAAQ,EAAE,QAAQ;CACnB,CAAC;;AAEF,SAAS,SAAS,CAAC,KAAK,EAAE,WAAW,EAAE;AACrC,SAAO,UAAS,GAAG,EAAE;AACnB,eAAW,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC7C,eAAW,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;GAC9B,CAAA;CACF;;;AAGD,KAAK,IAAI,CAAC,IAAI,MAAM,EAAE;AACpB,MAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AACtB,SAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC,CAAC;CACzD;;;AAGD,KAAK,IAAI,CAAC,IAAI,MAAM,EAAE;AACpB,MAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AACtB,OAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC,CAAC;CACrD;;AAED,KAAK,IAAI,CAAC,IAAI,MAAM,EAAE;AACpB,MAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AACtB,QAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC,CAAC;CACvD;;AAED,KAAK,IAAI,CAAC,IAAI,MAAM,EAAE;AACpB,MAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AACtB,SAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,SAAS,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC,CAAC;CACzD;;AAED,MAAM,CAAC,OAAO,GAAG;AACf,SAAO,EAAE,aAAa;AACtB,OAAK,EAAE,WAAW;AAClB,QAAM,EAAE,YAAY;AACpB,SAAO,EAAE,aAAa;CACvB,CAAC","file":"product.events.js","sourcesContent":[" /**\n  * Product model events\n  */\n\n 'use strict';\n\n var EventEmitter = require('events').EventEmitter;\n var Product = require('./product.model').product;\n var Image = require('./product.model').image;\n var Review = require('./product.model').review;\n var Variant = require('./product.model').variant;\n\n var ProductEvents = new EventEmitter();\n var ImageEvents = new EventEmitter();\n var ReviewEvents = new EventEmitter();\n var VariantEvents = new EventEmitter();\n\n\n // Set max event listeners (0 == unlimited)\n ProductEvents.setMaxListeners(0);\n ImageEvents.setMaxListeners(0);\n ReviewEvents.setMaxListeners(0);\n VariantEvents.setMaxListeners(0);\n\n // Model events\n var events = {\n   'save': 'save',\n   'remove': 'remove'\n };\n\n function emitEvent(event, ModelEvents) {\n   return function(doc) {\n     ModelEvents.emit(event + ':' + doc._id, doc);\n     ModelEvents.emit(event, doc);\n   }\n }\n\n // Register the event emitter to the model events\n for (var e in events) {\n   var event = events[e];\n   Product.schema.post(e, emitEvent(event, ProductEvents));\n }\n\n // Register the event emitter to the model events\n for (var e in events) {\n   var event = events[e];\n   Image.schema.post(e, emitEvent(event, ImageEvents));\n }\n // Register the event emitter to the model events\n for (var e in events) {\n   var event = events[e];\n   Review.schema.post(e, emitEvent(event, ReviewEvents));\n }\n // Register the event emitter to the model events\n for (var e in events) {\n   var event = events[e];\n   Variant.schema.post(e, emitEvent(event, VariantEvents));\n }\n\n module.exports = {\n   product: ProductEvents,\n   image: ImageEvents,\n   review: ReviewEvents,\n   variant: VariantEvents\n };\n"]}