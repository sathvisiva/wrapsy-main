{"version":3,"sources":["../../../../server/api/product/product.controller.js"],"names":[],"mappings":"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","file":"product.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n * GET     /api/products              ->  index\n * POST    /api/products              ->  create\n * GET     /api/products/:id          ->  show\n * PUT     /api/products/:id          ->  update\n * DELETE  /api/products/:id          ->  destroy\n */\n\n'use strict';\n\nvar _ = require('lodash');\n\n\nvar Product = require('./product.model').product;\nvar Image = require('./product.model').image;\nvar Variant = require('./product.model').variant;\nvar Review = require('./product.model').review;\nvar Catalog = require('../catalog/catalog.model');\nvar path = require('path');\n\nfunction handleError(res, statusCode) {\n  statusCode = statusCode || 500;\n  return function(err) {\n    console.error(err, statusCode);\n    res.status(statusCode).send(err);\n  };\n}\n\nfunction responseWithResult(res, statusCode) {\n  statusCode = statusCode || 200;\n  return function(entity) {\n    if (entity) {\n      res.status(statusCode).json(entity);\n    }\n  };\n}\n\nfunction handleEntityNotFound(res) {\n  return function(entity) {\n    if (!entity) {\n      res.status(404).end();\n      return null;\n    }\n    return entity;\n  };\n}\n\nfunction saveUpdates(updates) {\n  return function(entity) {\n    var updated = _.merge(entity, updates);\n    return updated.saveAsync()\n      .spread(function(updated) {\n        return updated;\n      });\n  };\n}\n\nfunction removeEntity(res) {\n  return function(entity) {\n    if (entity) {\n      return entity.removeAsync()\n        .then(function() {\n          res.status(204).end();\n        });\n    }\n  };\n}\n\nfunction saveFeaturedImage(res, file) {\n  return function(entity) {\n    var newPath = '/assets/uploads/' + path.basename(file.path);\n    entity.imageUrl = newPath;\n    return entity.saveAsync().spread(function(updated) {\n      return updated;\n    });\n  }\n}\n\nfunction productsInCategory(limit) {\n  limit = Number(limit) || null;\n  return function(catalog) {\n    var catalog_ids = [catalog._id].concat(catalog.children);\n    return Product\n      .find({\n        'categories': {\n          $in: catalog_ids\n        }\n      })\n      .limit(limit)\n      .populate({ path: 'categories', select: 'name' })\n      .populate({ path: 'reviews', select: 'rating' })\n      .populate({ path: 'images', select: 'imageUrl' })\n      .execAsync();\n  }\n}\n\nfunction productsInSearchCategory(term) {\n  return function(catalog) {\n    var catalog_ids = [catalog._id].concat(catalog.children);\n    var option;\n\n    if (catalog.slug == 'all')\n      option = {\n        $text: {\n          $search: term\n        }\n      };\n    else\n      option = {\n        'categories': {\n          $in: catalog_ids\n        },\n        $text: {\n          $search: term\n        }\n      };\n\n    return Product\n      .find(option)\n      .populate({ path: 'categories', select: 'name' })\n      .populate({ path: 'reviews', select: 'rating' })\n      .populate({ path: 'images', select: 'imageUrl' })\n      .execAsync();\n  }\n}\n\n// Gets a list of Products\nexports.index = function(req, res) {\n  Product.find().sort({ stock: 1 }).populate({ path: \"categories\", select: \"name\" }).execAsync()\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n// Gets a single Product from the DB\nexports.show = function(req, res) {\n  Product.findOne({\n      slug: req.params.slug\n    })\n    .populate('images')\n    .populate({ path: 'reviews' }).populate({ path: 'categories', select: 'slug' })\n    .execAsync()\n    .then(handleEntityNotFound(res))\n    .then(function(entity) {\n      if (entity) {\n        res.status(200).json(entity);\n      }\n    })\n    .catch(handleError(res));\n};\n\n// Creates a new Product in the DB\nexports.create = function(req, res) {\n  Product.createAsync(req.body)\n    .then(responseWithResult(res, 201))\n    .catch(handleError(res));\n};\n\n// Updates an existing Product in the DB\nexports.update = function(req, res) {\n  if (req.body._id) {\n    delete req.body._id;\n  }\n  Product.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(saveUpdates(req.body))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n// Deletes a Product from the DB\nexports.destroy = function(req, res) {\n  Product.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(removeEntity(res))\n    .catch(handleError(res));\n};\n\n// Uploads a new Product's featured image in the DB\nexports.upload = function(req, res) {\n  var file = req.files.file;\n  if (!file) {\n    return handleError(res)('File not provided');\n  }\n\n  Product.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(saveFeaturedImage(res, file))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\nexports.catalog = function(req, res) {\n  var limit = req.params.limit;\n  Catalog\n    .findOne({\n      slug: req.params.slug\n    })\n    .execAsync()\n    .then(productsInCategory(limit))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\nexports.search = function(req, res) {\n  var term = req.params.term;\n  Catalog\n    .findOne({\n      slug: req.params.slug\n    })\n    .execAsync()\n    .then(productsInSearchCategory(term))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n/*images*/\nfunction linkImageProduct(req, res, productId) {\n  return function(entity) {\n    var image = entity;\n    return Product.findByIdAsync(req.params.id)\n      .then(handleEntityNotFound(res))\n      .then(function(entity) {\n        entity.images.push(image._id);\n        return entity.saveAsync().spread(function() {\n          return image;\n        });\n      })\n  }\n}\n\nfunction getImages(res) {\n  return function(entity) {\n    if (entity) {\n      var images = _.map(entity.images, function(imageId) {\n        return Image.findByIdAsync(imageId)\n          .then(handleEntityNotFound(res));\n      })\n      return Promise.all(images);\n    } else {\n      return null;\n    }\n  }\n}\n\nfunction saveImageUpdates(file) {\n  return function(entity) {\n    var newPath = '/assets/uploads/' + path.basename(file.path);\n    var updated = _.merge(entity, {\n      imageUrl: newPath\n    });\n\n    return updated.saveAsync()\n      .spread(function(updated) {\n        return updated;\n      });\n  };\n}\n\n// Uploads a new Product's other images image in the DB\nexports.uploadImage = function(req, res) {\n  var file = req.files.file;\n  if (!file) {\n    return handleError(res)('File not provided');\n  }\n\n  var newPath = '/assets/uploads/' + path.basename(file.path);\n\n  Image.createAsync({\n      imageUrl: newPath\n    }).then(linkImageProduct(req, res, req.params.id))\n    .then(responseWithResult(res, 201))\n    .catch(handleError(res));\n};\n\n// Gets images for a single Product from the DB\nexports.indexImage = function(req, res) {\n  Product.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(getImages(res))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n// Updates an existing Product image in the DB\nexports.updateImage = function(req, res) {\n  var file = req.files.file;\n  if (!file) {\n    return handleError(res)('File not provided');\n  }\n\n  Image.findByIdAsync(req.params.image_id)\n    .then(handleEntityNotFound(res))\n    .then(saveImageUpdates(file))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n/*Variants*/\nfunction getVariants(res) {\n  return function(entity) {\n    if (entity) {\n      var variants = _.map(entity.variants, function(variantId) {\n        return Variant.findByIdAsync(variantId)\n          .then(handleEntityNotFound(res));\n      })\n      return Promise.all(variants);\n    } else {\n      return null;\n    }\n  }\n}\n\nfunction linkVariantProduct(res, productId) {\n  return function(entity) {\n    var variant = entity;\n    return Product.findByIdAsync(productId)\n      .then(handleEntityNotFound(res))\n      .then(function(entity) {\n        entity.variants.push(variant._id);\n        return entity.saveAsync().spread(function() {\n          return variant;\n        });\n      })\n  }\n}\n\nfunction removeVariantId(variantId, variant) {\n  return function(entity) {\n    var variantIndex = entity.variants.indexOf(variantId);\n    entity.variants.splice(variantIndex, 1);\n    return entity.saveAsync()\n      .then(function() {\n        return variant;\n      });\n  };\n}\n\nexports.createVariant = function(req, res) {\n  Variant.createAsync(req.body)\n    .then(linkVariantProduct(res, req.params.id))\n    .then(responseWithResult(res, 201))\n    .catch(handleError(res));\n}\n\n// Gets variants for a single Product from the DB\nexports.indexVariant = function(req, res) {\n  Product.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(getVariants(res))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n// Updates an existing Variant in the DB\nexports.updateVariant = function(req, res) {\n  if (req.body._id) {\n    delete req.body._id;\n  }\n  Variant.findByIdAsync(req.params.variant_id)\n    .then(handleEntityNotFound(res))\n    .then(saveUpdates(req.body))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n// Deletes a variant from the DB\nexports.destroyVariant = function(req, res) {\n\n  Variant.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(function(entity) {\n      var variant = entity;\n      return Product.findByIdAsync(req.params.id)\n        .then(handleEntityNotFound(res))\n        .then(removeVariantId(req.params.variant_id, variant));\n    })\n    .then(removeEntity(res))\n    .catch(handleError(res));\n};\n\n/*Reviews*/\nfunction getReviews(res) {\n  return function(entity) {\n    if (entity) {\n      var reviews = _.map(entity.reviews, function(reviewId) {\n        return Review.findByIdAsync(reviewId)\n          .then(handleEntityNotFound(res));\n      })\n      return Promise.all(reviews);\n    } else {\n      return null;\n    }\n  }\n}\n\nfunction linkReviewProduct(res, productId) {\n  return function(entity) {\n    var review = entity;\n    return Product.findByIdAsync(productId)\n      .then(handleEntityNotFound(res))\n      .then(function(entity) {\n        entity.reviews.push(review._id);\n        return entity.saveAsync().spread(function() {\n          return review;\n        });\n      })\n  }\n}\n\nfunction removeReviewId(reviewId, review) {\n  return function(entity) {\n    var reviewIndex = entity.reviews.indexOf(reviewId);\n    entity.reviews.splice(reviewIndex, 1);\n    return entity.saveAsync()\n      .then(function() {\n        return review;\n      });\n  };\n}\n\nexports.createReview = function(req, res) {\n  Review.createAsync(req.body)\n    .then(linkReviewProduct(res, req.params.id))\n    .then(responseWithResult(res, 201))\n    .catch(handleError(res));\n}\n\n// Gets reviews for a single Product from the DB\nexports.indexReview = function(req, res) {\n  Product.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(getReviews(res))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n// Updates an existing Variant in the DB\nexports.updateReview = function(req, res) {\n  if (req.body._id) {\n    delete req.body._id;\n  }\n  Review.findByIdAsync(req.params.review_id)\n    .then(handleEntityNotFound(res))\n    .then(saveUpdates(req.body))\n    .then(responseWithResult(res))\n    .catch(handleError(res));\n};\n\n// Deletes a variant from the DB\nexports.destroyReview = function(req, res) {\n\n  Review.findByIdAsync(req.params.id)\n    .then(handleEntityNotFound(res))\n    .then(function(entity) {\n      var review = entity;\n      return Product.findByIdAsync(req.params.id)\n        .then(handleEntityNotFound(res))\n        .then(removeReviewId(req.params.review_id, review));\n    })\n    .then(removeEntity(res))\n    .catch(handleError(res));\n};\n"]}