{"version":3,"sources":["../../../../server/api/product/product.socket.js"],"names":[],"mappings":"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","file":"product.socket.js","sourcesContent":["/**\n * Broadcast updates to client when the model changes\n */\n\n'use strict';\n\nvar ProductEvents = require('./product.events').product;\nvar ImageEvents = require('./product.events').image;\nvar ReviewEvents = require('./product.events').review;\nvar VariantEvents = require('./product.events').variant;\n\n// Model events to emit\nvar events = ['save', 'remove'];\n\nexports.register = function(socket) {\n  // Bind model events to socket events\n  for (var i = 0, eventsLength = events.length; i < eventsLength; i++) {\n    var event = events[i];\n    var listener = createListener('product:' + event, socket);\n\n    ProductEvents.on(event, listener);\n    socket.on('disconnect', removeListener(event, listener, ProductEvents));\n  }\n};\n\nexports.registerImage = function(socket) {\n  // Bind model events to socket events\n  for (var i = 0, eventsLength = events.length; i < eventsLength; i++) {\n    var event = events[i];\n    var listener = createListener('image:' + event, socket);\n\n    ImageEvents.on(event, listener);\n    socket.on('disconnect', removeListener(event, listener, ImageEvents));\n  }\n};\n\nexports.registerReview = function(socket) {\n  // Bind model events to socket events\n  for (var i = 0, eventsLength = events.length; i < eventsLength; i++) {\n    var event = events[i];\n    var listener = createListener('review:' + event, socket);\n\n    ReviewEvents.on(event, listener);\n    socket.on('disconnect', removeListener(event, listener, ReviewEvents));\n  }\n};\n\nexports.registerVariant = function(socket) {\n  // Bind model events to socket events\n  for (var i = 0, eventsLength = events.length; i < eventsLength; i++) {\n    var event = events[i];\n    var listener = createListener('variant:' + event, socket);\n\n    VariantEvents.on(event, listener);\n    socket.on('disconnect', removeListener(event, listener, VariantEvents));\n  }\n};\n\n\n\nfunction createListener(event, socket) {\n  return function(doc) {\n    socket.emit(event, doc);\n  };\n}\n\nfunction removeListener(event, listener, ModelEvents) {\n  return function() {\n    ModelEvents.removeListener(event, listener);\n  };\n}\n"]}