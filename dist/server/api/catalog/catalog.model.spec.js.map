{"version":3,"sources":["../../../../server/api/catalog/catalog.model.spec.js"],"names":[],"mappings":"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","file":"catalog.model.spec.js","sourcesContent":["var Catalog = require('./catalog.model');\nvar Product = require('../product/product.model').product;\n\ndescribe('Product+Catalog', function() {\n  var root, books, food, furniture;\n  var createCatalog = function (done){\n    Catalog\n      .find({})\n      .remove()\n      .then(function () {\n        return Product.find({}).remove();\n      })\n      .then(function () {\n        return Catalog.create({name: 'Navigation'})\n      })\n      .then(function (rootElement) {\n        root = rootElement;\n        return root.addChild({name: 'Books'});\n      })\n      .then(function (child) {\n        books = child;\n        return root.addChild({name: 'Food'});\n      })\n      .then(function (child) {\n        food = child;\n        return root.addChild({name: 'Furniture'});\n      })\n      .then(function (child) {\n        furniture = child;\n        done();\n      })\n      .then(null, done);\n  }\n\n  beforeEach(function (done) {\n    return createCatalog(done);\n  });\n\n  it('should create a product with book catetory', function(done) {\n    Product.create({title: 'Broccoli', price: 123, categories: [books._id]})\n      .then(function () {\n        return Product.findOne({}).populate(['categories', 'categories.parent']);\n      })\n      .then(function (newBook) {\n        var category = newBook.categories[0];\n        category.name.should.be.equal('Books');\n        category.slug.should.be.equal('books');\n        done();\n      })\n      .then(null, done);\n  });\n});\n\ndescribe('Finding products by category', function () {\n  var mainCatalog, electronics, books, clothing, vehicle, pantry, appliances;\n\n  var createProductsCatalog = function (callback) {\n    Catalog\n      .find({})\n      .remove()\n      .then(function () {\n        return Catalog.create({ name: 'All'});\n      })\n      .then(function (catalog) {\n        mainCatalog = catalog;\n        return mainCatalog.addChild({name: 'Electronics'});\n      })\n      .then(function (category) {\n        electronics = category._id;\n        return mainCatalog.addChild({name: 'Books'});\n      })\n      .then(function (category) {\n        books = category._id;\n        return mainCatalog.addChild({name: 'Clothing'});\n      })\n      .then(function (category) {\n        clothing = category._id;\n        return mainCatalog.addChild({name: 'Vehicle'});\n      })\n      .then(function (category) {\n        vehicle = category._id;\n        return mainCatalog.addChild({name: 'Pantry'});\n      })\n      .then(function (category) {\n        pantry = category._id;\n        return mainCatalog.addChild({name: 'Appliances'});\n      })\n      .then(function (category) {\n        appliances = category._id;\n        return Product.find({}).remove({});\n      })\n      .then(function() {\n        return Product.create({\n          title : 'GoPro HERO4 SILVER',\n          price : 399.99,\n          stock : 200,\n          categories : [electronics],\n          description : 'GoProâ€™s high-end camera model that features a new design with an integrated LCD, significantly increasing ease of use.'\n        }, {\n          title : 'Building an E-Commerce Application with MEAN',\n          price : 23.99,\n          stock : 950,\n          categories : [books],\n          description : 'Build an state-of-the-art using the MEAN stack (MongoDB, ExpressJS, AngularJS and NodeJS)'\n        }, {\n          title : 'Ray-Ban RB2132 Sunglasses',\n          price : 146.99,\n          stock : 10,\n          categories : [clothing],\n          description : 'Plastic imported Ray-Ban RB2132 New Wayfarer Sunglasses'\n        }, {\n          title : 'PlayStation 4 Console',\n          price : 399.95,\n          stock : 100,\n          categories : [electronics],\n          description : 'The PlayStation 4 system opens the door to an incredible journey through immersive new gaming worlds and a deeply connected gaming community. PS4 puts gamers first with an astounding launch lineup and over 180 games in development. Play amazing top-tier blockbusters and innovative indie hits on PS4. Developer Inspired, Gamer Focused.'\n        }, {\n          title : 'Toyota Corolla 2014',\n          price : 16493,\n          stock : 1,\n          categories : [vehicle],\n          description : 'ECO 38 MPG , CLEAN CARFAX , ONE OWNERS LOW MILEGE , LE POWER PACK , BACK UP CAMERA , BLUETOOTH , AUTOMATIC CLIMATE CONTROL , NONSMOKER , VERY CLEAN IN AND OUT , COMES WITH 2 KEYS , BOOKS , SERVICE RECORDS , 3YR / 36K FULL TOYOTA WARRANTY & FREE OIL CHANGES'\n        }, {\n          title : 'iPad Air 2 Wi-Fi 16GB - Silver',\n          price : 499,\n          stock : 15,\n          categories : [electronics],\n          description : 'The power and portability of iPad unlock possibilities that will change the way you do the things you love. '\n        });\n      })\n      .then(function () {\n        callback(null);\n      })\n      .then(null, callback);\n  }\n\n  beforeEach(function (done) {\n    return createProductsCatalog(done);\n  });\n\n  it('should find 3 electronic products', function(done) {\n    Product\n      .find({'categories': electronics })\n      .populate('categories')\n      .exec()\n      .then(function (products) {\n        products.length.should.be.equal(3);\n        done()\n      })\n      .then(null, done);\n  });\n\n  it('should find one vehicle and one clothing products', function (done) {\n    Product\n      .find({'categories': { $in: [vehicle, clothing]} })\n      .populate('categories')\n      .exec()\n      .then(function (products) {\n        products.length.should.be.equal(2);\n        done()\n      })\n      .then(null, done);\n  });\n\n\n  it('should find _all_ products', function (done) {\n    Product\n      .find({'categories': { $in: mainCatalog.children } })\n      .populate('categories')\n      .exec()\n      .then(function (products) {\n        expect(mainCatalog.children).to.contain(vehicle);\n        expect(mainCatalog.children).to.contain(clothing);\n        expect(mainCatalog.children).to.contain(electronics);\n        expect(mainCatalog.children).to.contain(books);\n        expect(mainCatalog.children).to.contain(pantry);\n        products.length.should.be.equal(6);\n        done()\n      })\n      .then(null, done);\n  });\n});\n"]}