{"version":3,"sources":["../../../../server/api/catalog/catalog.model.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;AACrE,IAAI,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;AAC7B,IAAI,KAAK,GAAG,OAAO,CAAC,oBAAoB,CAAC,CAAC;;AAG1C,IAAI,aAAa,GAAG,IAAI,MAAM,CAAC;AAC7B,OAAK,EAAE;AACL,QAAI,EAAE,MAAM;GACb;AACD,OAAK,EAAE,CAAC;AACN,QAAI,EAAE,MAAM;GACb,CAAC;CACH,CAAC,CAAC;;AAEH,IAAI,aAAa,GAAG,IAAI,MAAM,CAAC;AAC7B,MAAI,EAAE;AACJ,QAAI,EAAE,MAAM;AACZ,YAAQ,EAAE,IAAI;GACf;AACD,QAAM,EAAE;AACN,QAAI,EAAE,MAAM;GACb;AACD,WAAS,EAAE,CAAC;AACV,QAAI,EAAE,MAAM,CAAC,KAAK,CAAC,QAAQ;AAC3B,OAAG,EAAE,SAAS;GACf,CAAC;AACF,UAAQ,EAAE,CAAC;AACT,QAAI,EAAE,MAAM,CAAC,KAAK,CAAC,QAAQ;AAC3B,OAAG,EAAE,SAAS;GACf,CAAC;AACF,UAAQ,EAAG;AACT,QAAI,EAAE,MAAM;GACb;AACD,SAAO,EAAE,CAAC;AACR,QAAI,EAAE,MAAM,CAAC,KAAK,CAAC,QAAQ;AAC3B,OAAG,EAAE,SAAS;GACf,CAAC;;CAEH,CAAC,CAAC;;AAEH,aAAa,CAAC,OAAO,GAAG;AACtB,UAAQ,EAAE,kBAAS,KAAK,EAAE;AACxB,QAAI,IAAI,GAAG,IAAI,CAAC;AAChB,SAAK,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC;AACxB,SAAK,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACpD,WAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,WAAW,CAAC,UAAS,KAAK,EAAE;AACrE,UAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AAC9B,UAAI,CAAC,IAAI,EAAE,CAAC;KACb,CAAC,CAAC;GACJ;CACF,CAAA;;AAED,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;;AAEpC,QAAQ,CAAC,KAAK,CAAC,SAAS,EAAE,aAAa,CAAC,CAAA;;AAExC,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC","file":"catalog.model.js","sourcesContent":["'use strict';\n\nvar mongoose = require('bluebird').promisifyAll(require('mongoose'));\nvar Schema = mongoose.Schema;\nvar slugs = require('mongoose-url-slugs');\n\n\nvar FiltersSchema = new Schema({\n  label: {\n    type: String\n  },\n  value: [{\n    type: String\n  }],\n});\n\nvar CatalogSchema = new Schema({\n  name: {\n    type: String,\n    required: true\n  },\n  parent: {\n    type: String\n  },\n  ancestors: [{\n    type: Schema.Types.ObjectId,\n    ref: 'Catalog'\n  }],\n  children: [{\n    type: Schema.Types.ObjectId,\n    ref: 'Catalog'\n  }],\n  imageUrl : {\n    type: String\n  },\n  filters: [{\n    type: Schema.Types.ObjectId,\n    ref: 'Filters'\n  }],\n\n});\n\nCatalogSchema.methods = {\n  addChild: function(child) {\n    var that = this;\n    child.parent = this._id;\n    child.ancestors = this.ancestors.concat([this._id]);\n    return this.model('Catalog').create(child).addCallback(function(child) {\n      that.children.push(child._id);\n      that.save();\n    });\n  }\n}\n\nCatalogSchema.plugin(slugs('name'));\n\nmongoose.model('Filters', FiltersSchema)\n\nmodule.exports = mongoose.model('Catalog', CatalogSchema);\n"]}